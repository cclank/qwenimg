#!/bin/bash

# æ¢å¤ç¤ºä¾‹æ•°æ®

echo "ğŸ”„ æ¢å¤ QwenImg ç¤ºä¾‹æ•°æ®"
echo ""

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# 1. å¤åˆ¶å›¾ç‰‡æ–‡ä»¶
echo "1ï¸âƒ£ å¤åˆ¶å›¾ç‰‡æ–‡ä»¶..."
if [ -d "$SCRIPT_DIR/outputs" ]; then
    mkdir -p ../backend/outputs
    cp -v "$SCRIPT_DIR/outputs/"* ../backend/outputs/
    echo "âœ… å›¾ç‰‡æ–‡ä»¶å·²å¤åˆ¶"
else
    echo "âŒ æœªæ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶"
    exit 1
fi

# 2. å¯¼å…¥æ•°æ®åº“è®°å½•
echo ""
echo "2ï¸âƒ£ å¯¼å…¥æ•°æ®åº“è®°å½•..."
if [ -f "$SCRIPT_DIR/sample_tasks.sql" ]; then
    # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
    if [ -f "../venv/bin/activate" ]; then
        source ../venv/bin/activate
    fi
    
    # å¯¼å…¥æ•°æ®
    sqlite3 ../backend/qwenimg.db < "$SCRIPT_DIR/sample_tasks.sql"
    
    if [ $? -eq 0 ]; then
        echo "âœ… æ•°æ®åº“è®°å½•å·²å¯¼å…¥"
    else
        echo "âŒ æ•°æ®åº“è®°å½•å¯¼å…¥å¤±è´¥"
        exit 1
    fi
else
    echo "âŒ æœªæ‰¾åˆ°æ•°æ®åº“å¤‡ä»½æ–‡ä»¶"
    exit 1
fi

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘              âœ… ç¤ºä¾‹æ•°æ®æ¢å¤å®Œæˆï¼                    â•‘"
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo "â•‘  æç¤ºï¼š                                               â•‘"
echo "â•‘  - å·²æ¢å¤ 5 å¼ ç¤ºä¾‹å›¾ç‰‡                                â•‘"
echo "â•‘  - åˆ·æ–°æµè§ˆå™¨é¡µé¢å³å¯çœ‹åˆ°                             â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
